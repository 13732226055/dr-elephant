@*
* Copyright 2015 LinkedIn Corp.
*
* Licensed under the Apache License, Version 2.0 (the "License"); you may not
* use this file except in compliance with the License. You may obtain a copy of
* the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
* WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
* License for the specific language governing permissions and limitations under
* the License.
*@

@(title: String, results: Map[String, Map[String, List[model.JobResult]]])

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">@title</h3>
  </div>

  <ul class="list-group">
    @if(results != null){
      @for( (jobdefurl, flowexecmap) <- results) {
        <div class="list-group-item-alternate">
          <p><strong>Job Definition URL: </strong><a href=@jobdefurl>@jobdefurl</a></p>
          <div class="list-group well-lg">
            <!-- flowexecmap has two entries corresponding to the two flow execution urls and cannot be null. -->
            @for((flowexecurl, jobs) <- flowexecmap) {
              <div class="list-group">
                Flow Execution URL: <a href=@flowexecurl>@flowexecurl</a>
                @if(jobs != null) {
                  @for(result <- jobs) {
                    <a class="list-group-item list-group-item-@result.severity.getBootstrapColor()"
                       href="@routes.Application.search()?jobid=@result.jobId">
                      <p class="list-group-item-heading">
                        <div class="left">
                          <h4 class="list-group-item-heading">[@result.username] [@result.jobType] @result.jobId</h4>
                        </div>
                        <div class="right">@(tags.formatDate(result.analysisTime))</div>
                        <div>@result.jobName</div>
                      </p>
                      <p>
                        @for(heuristicResult <- result.heuristicResults) {
                          <span class="label label-@heuristicResult.severity.getBootstrapColor()">@heuristicResult.analysisName</span>
                        }
                      </p>
                    </a>
                  }
                }
              </div>
            }
          </div>
        </div>
      }
    }
  </ul>
</div>
